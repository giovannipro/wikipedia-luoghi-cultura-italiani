let lang,footer_it,footer_en,footer=document.getElementById("footer");function formatNumber(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}function apply_color(e){let t;return t="Letteratura italiana"==e||"Letteratura latina"==e||"Storia"==e||"Storia dell'arte"==e||"Filosofia"==e||"Grammatica italiana"==e||"Grammatica latina"==e?"#ef95c4":"Informatica"==e||"Tecnologia"==e?"#3a34e0":"Geografia"==e||"Diritto e Economia"==e||"Cittadinanza e costituzione"==e?"#00b2ff":"green",t}function format_date(e){if(0!=e){const t=e.substring(0,4),n=e.substring(5,7);return e.substring(8,10)+"-"+n+"-"+t}return"-"}function precentage(e,t){return parseFloat((100*e/t).toFixed(2))+"%"}function variation_perc(e,t,n){let i,o,a,r=e-t,c=.5;return r>0?(i=100*(e/t-1),s="+"):(i=100-100*e/t,s="-"),i>c&&"+"==s?"issues"==n?(sign="+",a="decrease"):(sign="+",a="increase"):i<c&&i>-.5?(sign="",a="stable"):"issues"==n?(sign="-",a="increase"):(sign="-",a="decrease"),0==e&&0==t?(o="-",a="stable"):o=i==1/0?"("+sign+r+")":i>c?"("+sign+i.toFixed(1)+"%)":i<c&&i>-.5?"-":"("+sign+i.toFixed(1)+"%)",[a,o]}const subjects=["Tutte le materie","Biologia","Chimica","Cittadinanza e costituzione","Diritto e Economia","Filosofia","Fisica","Geografia","Grammatica italiana","Grammatica latina","Informatica","Letteratura italiana","Letteratura latina","Matematica","Scienze della Terra","Scienze","Storia","Tecnologia"];function mobile_menu(){let e=!1;$("#mobile_menu_icon").click((function(){$("#mobile_menu_icon").css("display");if(0==e){let t=window.location.pathname;-1!=t.indexOf("autori")||-1!=t.indexOf("avvisi")?$("#mobile_menu_icon").css("background","url('../assets/img/close-menu.svg') center center no-repeat").css("background-size","55%"):$("#mobile_menu_icon").css("background","url('assets/img/close-menu.svg') center center no-repeat").css("background-size","55%"),$("#mobile_menu_box").show(),e=!0}else-1!=path.indexOf("autori")||-1!=path.indexOf("avvisi")?$("#mobile_menu_icon").css("background","url('../assets/img/mobile-menu.svg') center center no-repeat").css("background-size","55%"):$("#mobile_menu_icon").css("background","url('assets/img/mobile-menu.svg') center center no-repeat").css("background-size","55%"),$("#mobile_menu_box").hide(),e=!1}))}function mobile_filter(){let e=!1;$("#mobile_filter_icon").click((function(){let t=window.location.pathname;0==e?(-1!=t.indexOf("avvisi")||-1!=t.indexOf("autori")?$("#mobile_filter_icon").css("background","url('../assets/img/arrow-up.svg') center center no-repeat").css("background-size","55%"):$("#mobile_filter_icon").css("background","url('assets/img/arrow-up.svg') center center no-repeat").css("background-size","55%"),$("#select_box").show(),$("#select_box").css("display","flex"),e=!0):(-1!=t.indexOf("avvisi")||-1!=t.indexOf("autori")?$("#mobile_filter_icon").css("background","url('../assets/img/arrow-down.svg') center center no-repeat").css("background-size","55%"):$("#mobile_filter_icon").css("background","url('assets/img/arrow-down.svg') center center no-repeat").css("background-size","55%"),$("#select_box").hide(),e=!1)}))}function get_statistics(){window.addEventListener("keydown",(function(e){if("s"==e.key){let e=window.location.pathname,t=parseInt($("#year option:selected").val());-1==e.indexOf("avvisi")&&-1==e.indexOf("autori")?the_path="":the_path="../",d3.tsv(the_path+"assets/data/voci_"+t+".tsv").then((function(e){let t=0;e.forEach((function(e,n){t+=1,e.size=+e.size}));let n=d3.nest().key((e=>e.subject)).entries(e);console.group(),console.log("articoli",t),n=n.sort((function(e,t){return d3.descending(e.values.length,t.values.length)})),n.forEach((function(e,n){console.log(e.key,e.values.length,precentage(e.values.length,t))}));let i=d3.mean(e,(function(e){return Math.round(e.avg_pv)})),o=d3.mean(e,(function(e){return Math.round(e.avg_pv_prev)})),a=d3.mean(e,(function(e){return e.size})),r=d3.mean(e,(function(e){return e.size_prev})),s=d3.mean(e,(function(e){return e.incipit_size})),c=d3.mean(e,(function(e){return e.incipit_prev})),l=d3.mean(e,(function(e){return e.discussion_size})),u=d3.mean(e,(function(e){return e.discussion_prev})),d=d3.mean(e,(function(e){return e.issues})),g=d3.mean(e,(function(e){return e.issues_prev})),m=d3.mean(e,(function(e){return e.notes})),f=d3.mean(e,(function(e){return e.notes_prev})),_=d3.mean(e,(function(e){return e.images})),p=d3.mean(e,(function(e){return e.images_prev}));console.log("media visite giornaliere",Math.round(i),variation_perc(i,o,"avg_pv")),console.log("media byte articolo",Math.round(a),variation_perc(a,r,"avg_size")),console.log("media byte incipit ",Math.round(s),variation_perc(s,c,"avg_incipit")),console.log("media byte pagina di discussione",Math.round(l),variation_perc(l,u,"avg_discussion")),console.log("media avvisi",parseFloat(d.toFixed(3)),variation_perc(d,g,"avg_issues")),console.log("media note",Math.round(m),variation_perc(m,f,"avg_notes")),console.log("media immagini",Math.round(_),variation_perc(_,p,"avg_images")),console.groupEnd()}))}}))}function switch_the_language(){}function language(){const e=document.getElementById("language"),t=document.getElementById("language_mobile");let n,i=document.querySelectorAll(".language_name"),o=document.querySelectorAll(".en"),a=document.querySelectorAll(".it"),r=document.querySelectorAll(".lang_switch");e.addEventListener("click",l),t.addEventListener("click",l);new URL(window.location.href);const s=location.protocol+"//"+location.host+location.pathname;let c=new URLSearchParams(window.location.search);function l(){"it"==n?(n="en",o.forEach((e=>{e.style.display="block"})),a.forEach((e=>{e.style.display="none"})),i.forEach((e=>{e.innerHTML="IT"})),r.forEach((e=>{let t=e.dataset.en;e.dataset.it;e.textContent=t}))):(n="it",o.forEach((e=>{e.style.display="none"})),a.forEach((e=>{e.style.display="block"})),i.forEach((e=>{e.innerHTML="EN"})),r.forEach((e=>{e.dataset.en;let t=e.dataset.it;e.textContent=t}))),c.set("lang",n),newURL=s+"?lang="+n,window.history.replaceState({},"",newURL),path=window.location.pathname,"/"==path?update_dv1_lang(n):-1!=path.indexOf("viste")?update_dv2_lang(n):-1!=path.indexOf("avvisi")&&update_dv3_lang(n),update_footer(n),changeTitle(n)}1==c.has("lang")?(n=c.get("lang"),"it"==n?n="en":"en"==n&&(n="it"),l()):n="it"}function load_path(){const e=window.location.pathname;return-1==e.indexOf("viste")&&-1==e.indexOf("avvisi")?the_path="":the_path="../",the_path}function load_footer(){console.log(2);let e=new URLSearchParams(window.location.search);1==e.has("lang")&&(lang=e.get("lang"));let t=load_path();fetch(t+"assets/content/footer.html").then((e=>{if(!e.ok)throw new Error("Network response was not ok");return e.text()})).then((e=>{const t=document.createElement("div");t.innerHTML=e,footer_it=t.querySelector("#footer_it"),footer_en=t.querySelector("#footer_en"),the_footer="it"==lang?footer_it:footer_en,footer.append(the_footer)})).catch((e=>{console.error("There was a problem fetching the HTML:",e)}))}function update_footer(e){let t;t="it"==e?footer_it:footer_en,null!=t&&(footer.innerHTML="",footer.append(t))}function changeTitle(e){let t,n=document.title.split(" | ")[0];switch(n){case"Autori e pubblicazioni":t="Authors and publications";break;case"Authors and publications":t="Autori e pubblicazioni";break;case"Voci con avvisi":t="Articles with issues";break;case"Articles with issues":t="Voci con avvisi";break;case"Voci più viste":t="Most viewed articles";break;case"Most viewed articles":t="Voci più viste";break;default:t=n}document.title=t+" | Wikipedia e luoghi della cultura italiana"}window.onload=function(){mobile_menu(),mobile_filter(),language(),load_footer()};